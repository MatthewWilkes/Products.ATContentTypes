<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

<body>

<metal:block fill-slot="css_slot">
    <style type="text/css" media="screen"
           tal:content="string:@import url($portal_url/atcontenttypes.css);"></style>
</metal:block>


<div metal:fill-slot="main"
     tal:define="result python:here.atctListAlbum(images=1, folders=1, subimages=0, others=1);
                 images result/images;
                 albums result/folders;
                 otherContents result/others;
                 Batch python:modules['Products.CMFPlone'].Batch;
                 b_start python:request.get('b_start', 0);
                 batch python:Batch(images, 20, int(b_start), orphan=1)">

    <div metal:use-macro="here/document_actions/macros/document_actions">
        Document actions (print, sendto etc)
    </div>

    <h1 tal:content="here/title_or_id" class="documentFirstHeading">Title or id</h1>

    <div tal:content="here/Description" tal:condition="here/Description" class="documentDescription">
        Description
    </div>

    <div metal:use-macro="here/batch_macros/macros/navigation"></div>

    <tal:albumsimages tal:condition="python:albums or images">
        <tal:images tal:condition="batch" tal:repeat="image batch">
            <div class="photoAlbumEntry">
                <dl>
                    <dt>
                        <a tal:define="id python:int(b_start)+int(repeat['image'].number()-1)"
                           tal:attributes="href string:${here/absolute_url}/atct_album_image?b_start=$id">
                            <img tal:replace="structure python:image.tag(scale='thumb', title=image.Description())" />
                        </a>
                    </dt>
                    <dd tal:content="image/title_or_id">
                       Title
                    </dd>
                </dl>
            </div>
        </tal:images>

        <tal:albums tal:condition="albums" tal:repeat="album albums">
            <div class="photoAlbumEntry photoAlbumFolder"
                 tal:define="image_brains_in_album python:album.atctListAlbum(subimages=1)['subimages'];
                             number_of_images python:len(image_brains_in_album);
                             random python:modules['whrandom'];
                             random_image python:number_of_images and random.choice(image_brains_in_album).getObject() or None">
                <dl i18n:domain="atcontenttypes">
                    <dt>
                        <a tal:condition="number_of_images"
                           tal:attributes="href string:${album/absolute_url}/view">
                            <img tal:replace="structure python:random_image.tag(scale='thumb', title=album.Description())" />
                        </a>
                        <a tal:condition="not:number_of_images"
                           tal:attributes="href string:${album/absolute_url}/view" class="photoAlbumEmpty">
                          <span i18n:translate="text_empty_album"
                                tal:omit-tag="">Empty album</span>
                        </a>
                    </dt>
                    <dd>
                        <span tal:content="album/title_or_id">Title</span>
                        <span>(<span i18n:translate="photos_in_album" tal:omit-tag=""><tal:number
                                     i18n:name="num_photos" content="number_of_images" />
                                     photos in album</span>)</span>
                    </dd>
                </dl>
            </div>
        </tal:albums>

        <div class="visualClear"></div>

    </tal:albumsimages>

    <p i18n:domain="atcontenttypes"
       i18n:translate="text_no_albuns_uploaded"
       tal:condition="python:not (albums or images)">
        No albums or photos uploaded yet.
    </p>

    <div tal:condition="python:albums or images"
         metal:use-macro="here/batch_macros/macros/navigation" />

    <tal:listing condition="otherContents"
                 define="global getObjSize nocall:here/getObjSize;
                         global toPortalTime nocall:here/toPortalTime;">

      <dl>
          <tal:entry tal:repeat="obj otherContents">

          <dt metal:define-macro="list-item"
              tal:define="url python: obj.absolute_url()+test(obj.isPrincipiaFolderish,'/','');
                          icon python: obj.getIcon(1)">
              <a href="#" tal:attributes="href url">
                  <img src="" alt=""
                       tal:attributes="src string:${utool}/${icon};alt here/title" />
              </a>

              <a href="#" tal:condition="python: obj.portal_type not in ['Link', 'Image']"
                          tal:attributes="href url"
                          tal:content="obj/title_or_id" />

              <a href="#" tal:condition="python: obj.portal_type == 'Image'"
                          tal:attributes="href python: url + '/view'"
                          tal:content="obj/title_or_id" />

              <a href="#"
                 class="link-plain"
                 tal:condition="python: obj.portal_type == 'Link'"
                 tal:attributes="href obj/getRemoteUrl;"
                 tal:content="obj/title_or_id" />

              <span class="discreet"
                    tal:condition="python: obj.portal_type == 'Event'">
                  &nbsp;
                  <span tal:replace="obj/location">Oslo</span>,
                  <span tal:replace="python: obj.start().ISO()">from date</span> -
                  <span tal:replace="python: obj.end().ISO()">to date</span>

              </span>
          </dt>

          <dd>
              <span tal:content="python:test(obj.Description(), obj.Description(), '&nbsp;')">
                  description
              </span>
          </dd>
          </tal:entry>
      </dl>

  </tal:listing>

</div>

</body>

</html>
